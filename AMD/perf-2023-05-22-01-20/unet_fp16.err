In file included from main.cpp:4:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:4:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
2 errors generated when compiling for gfx908.
terminate called after throwing an instance of 'migraphx::version_1::exception'
  what():  /src/AMDMIGraphX/src/process.cpp:97: check_exec: Command cd /tmp/migraphx-compile-6bbb-7fe4803f6700-643d5a5a49fa98-poVmFdoDvF22HHQM; /opt/rocm/llvm/bin/clang++ -Wno-float-equal -DMIGRAPHX_NGLOBAL=327680 -DMIGRAPHX_NLOCAL=1024 -Weverything -Wno-c++98-compat -Wno-c++98-compat-pedantic -Wno-conversion -Wno-double-promotion -Wno-exit-time-destructors -Wno-extra-semi -Wno-extra-semi-stmt -Wno-float-conversion -Wno-gnu-anonymous-struct -Wno-gnu-zero-variadic-macro-arguments -Wno-missing-prototypes -Wno-nested-anon-types -Wno-padded -Wno-shorten-64-to-32 -Wno-sign-conversion -Wno-sign-compare -Wno-unused-command-line-argument -Wno-weak-vtables -Wno-c99-extensions -ftemplate-backtrace-limit=0 -Werror --std=c++17 -fno-gpu-rdc -c --offload-arch=gfx908:sramecc+:xnack- --cuda-device-only -O3  -Wno-unused-command-line-argument -Wno-cuda-compat -mllvm -amdgpu-early-inline-all=true -mllvm -amdgpu-function-calls=false -x hip -isystem /opt/rocm-5.4.2/include -isystem /opt/rocm-5.4.2/llvm/lib/clang/15.0.0/include/.. -D__HIP_PLATFORM_HCC__=1 -D__HIP_PLATFORM_AMD__=1 -isystem /opt/rocm-5.4.2/include -isystem /opt/rocm/include --hip-link --hip-link -I. main.cpp -o main.o exited with status 1
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)In file included from 
main.cpp                                                     ~~^~~~~~:
3                                                       __fmax:

In file included from ./migraphx/kernels/pointwise.hpp:29./migraphx/kernels/math.hpp:
:./migraphx/kernels/math.hpp67::19164::56 :note:  expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'error: 
no member named '__hmax' in the global namespace; did you mean '__fmax'?
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~/usr/include/x86_64-linux-gnu/bits/mathcalls.h
:                                                       __fmax329
:1:./migraphx/kernels/math.hpp :note: 67'__fmax' declared here:
64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:    inline auto __device__ name(type x, type y)->type { return fname(x, y); }278
:                                                               ^~~~~3
: note: expanded from macro '__MATHCALLX'
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note:   __MATHDECLX (_Mdouble_,function,suffix, args, attrib)'__fmax' declared here

  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

^
/usr/include/math.h:278:3: note:   __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)expanded from macro '__MATHCALLX'

                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23:  __MATHDECLX (_Mdouble_,function,suffix, args, attrib) 
note:   ^expanded from macro '__CONCAT'

/usr/include/math.h:281:22:#define __CONCAT(x,y)   x ## y 
note:                         ^expanded from macro '__MATHDECLX'

<scratch space>:117:1: note: expanded from here  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)

                     ^__fmax

^/usr/include/x86_64-linux-gnu/sys/cdefs.h
:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
In file included from main.cpp:__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));3
:
^In file included from 
./migraphx/kernels/pointwise.hpp:29:
/usr/include/math.h./migraphx/kernels/math.hpp::278192::356::  note: error: expanded from macro '__MATHCALLX'no member named '__hmin' in the global namespace; did you mean '__fmin'?

  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.hMIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin):
281                                                     ~~^~~~~~:
22                                                       __fmin:
 note: expanded from macro '__MATHDECLX'./migraphx/kernels/math.hpp
:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:    inline auto __device__ name(type x, type y)->type { return fname(x, y); }23
:                                                               ^~~~~ 
note: expanded from macro '__CONCAT'
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:#define __CONCAT(x,y)   x ## y1
:                        ^ 
note: '__fmin' declared here<scratch space>
:118:1: note: expanded from here
__fmin__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

^^

/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1In file included from :main.cpp :note: 3expanded from here:

In file included from __fmin./migraphx/kernels/pointwise.hpp
:^29
:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/layernorm.hpp:26:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
In file included from <scratch space>main.cpp::1173::
1In file included from :./migraphx/kernels/softmax.hpp :note: 27expanded from here:

In file included from ./migraphx/kernels/reduce.hpp__fmax:
30^:

In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:In file included from 56main.cpp:: 3error: :
no member named '__hmax' in the global namespace; did you mean '__fmax'?In file included from 
./migraphx/kernels/pointwise.hpp:In file included from 29main.cpp:
:./migraphx/kernels/math.hpp3::
192MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)In file included from :
./migraphx/kernels/layernorm.hpp56                                                     ~~^~~~~~::
26                                                        __fmax:
error: 
In file included from no member named '__hmin' in the global namespace; did you mean '__fmin'?./migraphx/kernels/reduce.hpp./migraphx/kernels/math.hpp
::3067:
:In file included from 64./migraphx/kernels/ops.hpp:: MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)27note: 
:
expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'                                                     ~~^~~~~~./migraphx/kernels/math.hpp

:                                                       __fmin191
:56./migraphx/kernels/math.hpp:    inline auto __device__ name(type x, type y)->type { return fname(x, y); }: 
67error:                                                                ^~~~~:no member named '__hmax' in the global namespace; did you mean '__fmax'?
64
: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)                                                               ^~~~~

                                                     ~~^~~~~~__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

                                                       __fmax/usr/include/x86_64-linux-gnu/bits/mathcalls.h^
:
332./migraphx/kernels/math.hpp::/usr/include/math.h167:::278 64:note: :3'__fmin' declared here :
note:  expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'note: 
expanded from macro '__MATHCALLX'
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278  __MATHDECLX (_Mdouble_,function,suffix, args, attrib):    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
3
  ^:                                                               ^~~~~
 
note: /usr/include/math.hexpanded from macro '__MATHCALLX':
281/usr/include/x86_64-linux-gnu/bits/mathcalls.h::22329::  __MATHDECLX (_Mdouble_,function,suffix, args, attrib) 1
note: :  ^expanded from macro '__MATHDECLX' In file included from 

note: main.cpp/usr/include/math.h'__fmax' declared here::
3281:
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib):In file included from 
22./migraphx/kernels/pointwise.hpp                     ^__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));::

 29^note: /usr/include/x86_64-linux-gnu/sys/cdefs.h:

expanded from macro '__MATHDECLX':./migraphx/kernels/math.hpp
105/usr/include/math.h:::19123278:::  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)56 3
:note: :                     ^ expanded from macro '__CONCAT' 
error: 
note: /usr/include/x86_64-linux-gnu/sys/cdefs.hno member named '__hmax' in the global namespace; did you mean '__fmax'?expanded from macro '__MATHCALLX':
#define __CONCAT(x,y)   x ## y
105
:                        ^23
:  __MATHDECLX (_Mdouble_,function,suffix, args, attrib) 
note: <scratch space>  ^MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)expanded from macro '__CONCAT':


117/usr/include/math.h                                                     ~~^~~~~~::
#define __CONCAT(x,y)   x ## y1281                                                       __fmax
::
                        ^ 22
note: ./migraphx/kernels/math.hpp:<scratch space>expanded from here: :
67note: 118:__fmaxexpanded from macro '__MATHDECLX':64

1:^: 
 note: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)expanded from here


                     ^
__fmin
/usr/include/x86_64-linux-gnu/sys/cdefs.h^:
105    inline auto __device__ name(type x, type y)->type { return fname(x, y); }:
23                                                               ^~~~~:
 note: expanded from macro '__CONCAT'
/usr/include/x86_64-linux-gnu/bits/mathcalls.h#define __CONCAT(x,y)   x ## y:
329                        ^:
1: note: '__fmax' declared here
<scratch space>:117:1: note: expanded from here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));__fmax

^^

/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
In file included from ./migraphx/kernels/math.hppmain.cpp::673::
64In file included from :./migraphx/kernels/layernorm.hpp :note: 26expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR':

In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:    inline auto __device__ name(type x, type y)->type { return fname(x, y); }191
:                                                               ^~~~~56
: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?/usr/include/x86_64-linux-gnu/bits/mathcalls.h
:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
/usr/include/math.h                                                     ~~^~~~~~:
278                                                       __fmax:
3: ./migraphx/kernels/math.hppnote: :expanded from macro '__MATHCALLX'67
:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note:     inline auto __device__ name(type x, type y)->type { return fname(x, y); }expanded from macro '__MATHDECLX'

                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)329
:                     ^1
: /usr/include/x86_64-linux-gnu/sys/cdefs.hnote: :'__fmax' declared here105
:23: note: expanded from macro '__CONCAT'
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));#define __CONCAT(x,y)   x ## y

^                        ^

<scratch space>:/usr/include/math.h118::2781::3 :note:  expanded from herenote: 
expanded from macro '__MATHCALLX'
__fmin
^
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from hereIn file included from 
main.cpp__fmax:
3^:

In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:4:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/layernorm.hpp:26:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
In file included from ./migraphx/kernels/math.hppmain.cpp::1923::
56In file included from :./migraphx/kernels/pointwise.hpp :error: 29In file included from no member named '__hmin' in the global namespace; did you mean '__fmin'?:
main.cpp
./migraphx/kernels/math.hpp::3191:
In file included from :In file included from MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)main.cpp56./migraphx/kernels/pointwise.hpp
:::                                                     ~~^~~~~~3 29
:
error: :
                                                       __fminIn file included from no member named '__hmax' in the global namespace; did you mean '__fmax'?./migraphx/kernels/math.hpp
./migraphx/kernels/layernorm.hpp
::./migraphx/kernels/math.hpp19226:::
6756In file included from ::./migraphx/kernels/reduce.hpp64 ::MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)error: 30 
no member named '__hmin' in the global namespace; did you mean '__fmin'?:
note:                                                      ~~^~~~~~
In file included from expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
./migraphx/kernels/ops.hpp
                                                       __fmax:
27:
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)./migraphx/kernels/math.hpp./migraphx/kernels/math.hpp
::                                                     ~~^~~~~~    inline auto __device__ name(type x, type y)->type { return fname(x, y); }19267

::                                                       __fmin                                                               ^~~~~5664

::./migraphx/kernels/math.hpp /usr/include/x86_64-linux-gnu/bits/mathcalls.h :error: :note: 67no member named '__hmin' in the global namespace; did you mean '__fmin'?332expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR':
:
641::  note: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR''__fmin' declared here
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)    inline auto __device__ name(type x, type y)->type { return fname(x, y); }


                                                     ~~^~~~~~                                                               ^~~~~

                                                       __fmin    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

                                                               ^~~~~/usr/include/x86_64-linux-gnu/bits/mathcalls.h./migraphx/kernels/math.hpp^
::
32967/usr/include/x86_64-linux-gnu/bits/mathcalls.h::/usr/include/math.h:164:332::278:  :1note: note: 3:'__fmax' declared hereexpanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR': 

 note: note: '__fmin' declared hereexpanded from macro '__MATHCALLX'

__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }^

                                                               ^~~~~__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)

/usr/include/math.h
^:  ^
/usr/include/x86_64-linux-gnu/bits/mathcalls.h278
:/usr/include/math.h:332/usr/include/math.h:3::278:1281: ::3note:  22:expanded from macro '__MATHCALLX'note: : 
'__fmin' declared here note: 
note: expanded from macro '__MATHCALLX'expanded from macro '__MATHDECLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)

  ^__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)^/usr/include/math.h

:  ^  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)281
/usr/include/math.h
:/usr/include/math.h:                     ^22:278
:281: /usr/include/x86_64-linux-gnu/sys/cdefs.h:3note: :22:expanded from macro '__MATHDECLX'105: 
: note: 23note: expanded from macro '__MATHCALLX':expanded from macro '__MATHDECLX'
 
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)note: 
expanded from macro '__CONCAT'                     ^
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)

  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)  ^/usr/include/x86_64-linux-gnu/sys/cdefs.h#define __CONCAT(x,y)   x ## y

:
                     ^/usr/include/math.h105                        ^
::
281/usr/include/x86_64-linux-gnu/sys/cdefs.h23:<scratch space>::22:105 :118:note:  :23expanded from macro '__CONCAT'note: 1:
expanded from macro '__MATHDECLX': 
 note: #define __CONCAT(x,y)   x ## ynote: expanded from macro '__CONCAT'
expanded from here
                        ^
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
#define __CONCAT(x,y)   x ## y
__fmin
                     ^
<scratch space>                        ^
^:

/usr/include/x86_64-linux-gnu/sys/cdefs.h117<scratch space>:::1051118:::23 1:note: : expanded from here note: 
note: expanded from macro '__CONCAT'expanded from here__fmax


__fmin^

#define __CONCAT(x,y)   x ## y^

                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
In file included from main.cpp:3:
In file included from     inline auto __device__ name(type x, type y)->type { return fname(x, y); }./migraphx/kernels/layernorm.hpp
:                                                               ^~~~~26
:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27/usr/include/x86_64-linux-gnu/bits/mathcalls.h:
:./migraphx/kernels/math.hpp329::1911::56 :note:  '__fmax' declared hereerror: 
no member named '__hmax' in the global namespace; did you mean '__fmax'?
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.hMIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax):
278                                                     ~~^~~~~~:
3                                                       __fmax:
 note: expanded from macro '__MATHCALLX'./migraphx/kernels/math.hpp
:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22:    inline auto __device__ name(type x, type y)->type { return fname(x, y); } 
note:                                                                ^~~~~expanded from macro '__MATHDECLX'

/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib):
                      ^note: 
'__fmax' declared here
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

^
#define __CONCAT(x,y)   x ## y/usr/include/math.h
:                        ^278
:3: note: expanded from macro '__MATHCALLX'<scratch space>
:117:1: note: expanded from here  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)

  ^__fmax

/usr/include/math.h^:
281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/layernorm.hpp:26:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:4:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: In file included from note: main.cppexpanded from macro '__MATHCALLX':
3:
In file included from ./migraphx/kernels/layernorm.hpp:26:
In file included from ./migraphx/kernels/reduce.hpp:  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)30
:
  ^In file included from 
./migraphx/kernels/ops.hpp/usr/include/math.h::27281:
:./migraphx/kernels/math.hpp22::191 :note: 56expanded from macro '__MATHDECLX':
 error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax):
                                                      ~~^~~~~~note: 
expanded from macro '__CONCAT'                                                       __fmax

./migraphx/kernels/math.hpp:#define __CONCAT(x,y)   x ## y67
:                        ^64
:<scratch space> :note: 118expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR':
1: note: expanded from here
__fmin
^
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/layernorm.hpp:26:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: In file included from note: main.cppexpanded from macro '__CONCAT':
3:
In file included from ./migraphx/kernels/softmax.hpp:27#define __CONCAT(x,y)   x ## y:

In file included from                         ^./migraphx/kernels/reduce.hpp
:<scratch space>30::
118In file included from :./migraphx/kernels/ops.hpp1::27 :
note: ./migraphx/kernels/math.hppexpanded from here:
192:__fmin56
:^ 
error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/layernorm.hpp:26:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from In file included from main.cppmain.cpp::33:
:
In file included from In file included from ./migraphx/kernels/pointwise.hpp./migraphx/kernels/pointwise.hpp::2929:
:
./migraphx/kernels/math.hpp./migraphx/kernels/math.hpp::191191::5656::  error: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?no member named '__hmax' in the global namespace; did you mean '__fmax'?

MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)

                                                     ~~^~~~~~                                                     ~~^~~~~~

                                                       __fmax                                                       __fmax

./migraphx/kernels/math.hpp./migraphx/kernels/math.hpp::6767::6464::  note: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'

    inline auto __device__ name(type x, type y)->type { return fname(x, y); }    inline auto __device__ name(type x, type y)->type { return fname(x, y); }

                                                               ^~~~~                                                               ^~~~~

/usr/include/x86_64-linux-gnu/bits/mathcalls.h/usr/include/x86_64-linux-gnu/bits/mathcalls.h::329329::11::  note: note: '__fmax' declared here'__fmax' declared here

__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

^^

/usr/include/math.h/usr/include/math.h::278278::33::  note: note: expanded from macro '__MATHCALLX'expanded from macro '__MATHCALLX'

  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)

  ^  ^

/usr/include/math.h/usr/include/math.h::281281::2222::  note: note: expanded from macro '__MATHDECLX'expanded from macro '__MATHDECLX'

  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)

                     ^                     ^

/usr/include/x86_64-linux-gnu/sys/cdefs.h/usr/include/x86_64-linux-gnu/sys/cdefs.h::105105::2323::  note: note: expanded from macro '__CONCAT'expanded from macro '__CONCAT'

#define __CONCAT(x,y)   x ## y#define __CONCAT(x,y)   x ## y

                        ^                        ^

<scratch space><scratch space>::117117::11::  note: note: expanded from hereexpanded from here

__fmax__fmax

^^

In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:In file included from 1main.cpp:: 3note: :
'__fmin' declared hereIn file included from 
./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:191:56: error: __MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));no member named '__hmax' in the global namespace; did you mean '__fmax'?

^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
./migraphx/kernels/math.hpp  ^:
67/usr/include/math.h::64281:: 22note: :expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR' 
note: expanded from macro '__MATHDECLX'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)

                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105/usr/include/x86_64-linux-gnu/bits/mathcalls.h::23329:: 1note: :expanded from macro '__CONCAT' 
note: '__fmax' declared here
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));:
1^:
 note: expanded from here/usr/include/math.h
:278__fmin:
3^:
 note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from In file included from main.cppmain.cpp::33:
:
In file included from In file included from ./migraphx/kernels/pointwise.hpp./migraphx/kernels/pointwise.hpp::2929:
:
./migraphx/kernels/math.hpp./migraphx/kernels/math.hpp::192192::5656::  error: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?no member named '__hmin' in the global namespace; did you mean '__fmin'?

MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)

                                                     ~~^~~~~~                                                     ~~^~~~~~

                                                       __fmin                                                       __fmin

./migraphx/kernels/math.hpp./migraphx/kernels/math.hpp::6767::6464::  note: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'

    inline auto __device__ name(type x, type y)->type { return fname(x, y); }    inline auto __device__ name(type x, type y)->type { return fname(x, y); }

                                                               ^~~~~                                                               ^~~~~

/usr/include/x86_64-linux-gnu/bits/mathcalls.h/usr/include/x86_64-linux-gnu/bits/mathcalls.h::332332::11::  note: note: '__fmin' declared here'__fmin' declared here

__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));

^^

/usr/include/math.h/usr/include/math.h::278278::33::  note: note: expanded from macro '__MATHCALLX'expanded from macro '__MATHCALLX'

  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)

  ^  ^

/usr/include/math.h/usr/include/math.h::281281::2222::  note: note: expanded from macro '__MATHDECLX'expanded from macro '__MATHDECLX'

  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)

                     ^                     ^

/usr/include/x86_64-linux-gnu/sys/cdefs.h/usr/include/x86_64-linux-gnu/sys/cdefs.h::105105::2323::  note: note: expanded from macro '__CONCAT'expanded from macro '__CONCAT'

#define __CONCAT(x,y)   x ## y#define __CONCAT(x,y)   x ## y

                        ^                        ^

<scratch space><scratch space>::118118::11::  note: note: expanded from hereexpanded from here

__fmin__fmin

^^

In file included from main.cpp:3:
In file included from ./migraphx/kernels/pointwise.hpp:29:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: no member named '__hmax' in the global namespace; did you mean '__fmax'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                     ~~^~~~~~
                                                       __fmax
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:192:56: error: no member named '__hmin' in the global namespace; did you mean '__fmin'?
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, min, ::__hmin)
                                                     ~~^~~~~~
                                                       __fmin
./migraphx/kernels/math.hpp:67:64: note: expanded from macro 'MIGRAPHX_DEVICE_MATH_BINARY_FOR'
    inline auto __device__ name(type x, type y)->type { return fname(x, y); }
                                                               ^~~~~
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:332:1: note: '__fmin' declared here
__MATHCALLX (fmin,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:118:1: note: expanded from here
__fmin
^
timeout: the monitored command dumped core
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: reference to __host__ function '__fmax' in __device__ function
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                       ^
./migraphx/kernels/ops.hpp:93:26: note: called by 'operator()<_Float16, _Float16>'
        return migraphx::max(x, y);
                         ^
./migraphx/kernels/reduce.hpp:110:51: note: called by 'operator()<unsigned int, migraphx::integral_constant<int, 0>>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
                                                  ^
./migraphx/kernels/index.hpp:154:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:110:25), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i, d);
               ^
./migraphx/kernels/index.hpp:198:25: note: called by 'for_stride<true, (lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 32>, migraphx::integral_constant<unsigned int, 64>>'
                        invoke_loop(f, start, _c<0>);
                        ^
./migraphx/kernels/index.hpp:232:9: note: called by 'local_stride<(lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 32>>'
        for_stride<true>(local, n, nlocal(), f);
        ^
./migraphx/kernels/reduce.hpp:110:9: note: called by 'block_reduce<migraphx::op::max, migraphx::lowest, migraphx::integral_constant<unsigned int, 32>, (lambda at ./migraphx/kernels/reduce.hpp:373:51)>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
        ^
./migraphx/kernels/reduce.hpp:373:20: note: called by 'reduce_impl<migraphx::op::max, migraphx::lowest, migraphx::op::id, migraphx::integral_constant<unsigned int, 32>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(2))), 1, migraphx::integral_constant<unsigned int, 32>> &>'
            return block_reduce(idx, op, init, n, [&](auto j, auto d) {
                   ^
./migraphx/kernels/reduce.hpp:314:28: note: called by 'operator()<migraphx::integral_constant<unsigned int, 32>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(2))), 1, migraphx::integral_constant<unsigned int, 32>>>'
            return derived.reduce_impl(op, init, read, n, xs...);
                           ^
./migraphx/kernels/reduce.hpp:278:43: note: called by 'operator()<migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(2))), 1, migraphx::integral_constant<unsigned int, 32>> &>'
        return [=](auto&&... xs) { return f(get_size(xs...), make_inner_slice(xs)...); };
                                          ^
./migraphx/kernels/softmax.hpp:41:24: note: called by 'operator()<migraphx::array<unsigned int, 3>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>>'
        const auto c = r.reduce(op::max{}, lowest{}, op::id{})(input);
                       ^
./migraphx/kernels/reduce.hpp:414:13: note: called by 'operator()<unsigned int>'
            f(out_idx, make(idx, [&](auto input) { return reduce_slice<Output>(input, out_idx); }));
            ^
./migraphx/kernels/index.hpp:160:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:412:53), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i);
               ^
./migraphx/kernels/index.hpp:202:21: note: called by 'for_stride<false, (lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 1310720>, migraphx::integral_constant<unsigned int, 1310720>>'
                    invoke_loop(f, start, _c<0>);
                    ^
./migraphx/kernels/index.hpp:226:9: note: called by 'global_stride<(lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 1310720>>'
        for_stride<false>(global, n, nglobal(), f);
        ^
./migraphx/kernels/reduce.hpp:412:13: note: called by 'run<migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 1>, migraphx::integral_const_array<unsigned int, 32768, 32, 1>>, (lambda at ./migraphx/kernels/softmax.hpp:36:57)>'
        idx.global_stride(nelements * idx.nlocal(), [&](auto i) {
            ^
./migraphx/kernels/softmax.hpp:36:21: note: called by 'softmax<2U, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(2))), migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 32>, migraphx::integral_const_array<unsigned int, 32768, 32, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(2))), migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 32>, migraphx::integral_const_array<unsigned int, 32768, 32, 1>>>>'
    block::template run<reduce::with_axis<Input, Axis>>([&](auto, auto r) {
                    ^
main.cpp:13:9: note: called by 'operator()<migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(2))), migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 32>, migraphx::integral_const_array<unsigned int, 32768, 32, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(2))), migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 32>, migraphx::integral_const_array<unsigned int, 32768, 32, 1>>>>'
        softmax<2>(input, output);
        ^
2./migraphx/kernels/vectorize.hpp error:s257 generated: when compiling for 13gfx908:.
 note: called by 'operator()<(lambda at main.cpp:12:74), migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 64>, migraphx::integral_const_array<unsigned int, 65536, 64, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 64>, migraphx::integral_const_array<unsigned int, 65536, 64, 1>>>>'
            f(vectorize_tensor<N, Axis>(xs)...);
            ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
./migraphx/kernels/functional.hpp:273:50: note: called by 'operator()<migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 64>, migraphx::integral_const_array<unsigned int, 65536, 64, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 20, 1024, 64>, migraphx::integral_const_array<unsigned int, 65536, 64, 1>>>>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
                                                 ^
./migraphx/kernels/args.hpp:39:12: note: called by 'make_tensors_impl<(lambda at ./migraphx/kernels/functional.hpp:273:25), 0U, 1U, void, void>'
    return f(make_tensor<Ns>::apply(xs)...);
           ^
./migraphx/kernels/args.hpp:45:37: note: called by 'operator()<(lambda at ./migraphx/kernels/functional.hpp:273:25)>'
        return [=](auto f) { return make_tensors_impl(f, detail::gens<sizeof...(xs)>{}, xs...); };
                                    ^
./migraphx/kernels/functional.hpp:273:16: note: called by 'operator()<(lambda at main.cpp:12:74), void *, void *>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
               ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
main.cpp:12:73: note: called by 'softmax_kernel'
    transform_args(make_tensors(), vectorize<2, 2>())(input_p, output_p)([](auto input, auto output) {
                                                                        ^
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
3 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: reference to __host__ function '__fmax' in __device__ function
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                       ^
./migraphx/kernels/ops.hpp:93:26: note: called by 'operator()<_Float16, _Float16>'
        return migraphx::max(x, y);
                         ^
./migraphx/kernels/reduce.hpp:110:51: note: called by 'operator()<unsigned int, migraphx::integral_constant<int, 0>>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
                                                  ^
./migraphx/kernels/index.hpp:154:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:110:25), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i, d);
               ^
./migraphx/kernels/index.hpp:198:25: note: called by 'for_stride<true, (lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 16>, migraphx::integral_constant<unsigned int, 64>>'
                        invoke_loop(f, start, _c<0>);
                        ^
./migraphx/kernels/index.hpp:232:9: note: called by 'local_stride<(lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 16>>'
        for_stride<true>(local, n, nlocal(), f);
        ^
./migraphx/kernels/reduce.hpp:110:9: note: called by 'block_reduce<migraphx::op::max, migraphx::lowest, migraphx::integral_constant<unsigned int, 16>, (lambda at ./migraphx/kernels/reduce.hpp:373:51)>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
        ^
./migraphx/kernels/reduce.hpp:373:20: note: called by 'reduce_impl<migraphx::op::max, migraphx::lowest, migraphx::op::id, migraphx::integral_constant<unsigned int, 16>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 1, migraphx::integral_constant<unsigned int, 16>> &>'
            return block_reduce(idx, op, init, n, [&](auto j, auto d) {
                   ^
./migraphx/kernels/reduce.hpp:314:28: note: called by 'operator()<migraphx::integral_constant<unsigned int, 16>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 1, migraphx::integral_constant<unsigned int, 16>>>'
            return derived.reduce_impl(op, init, read, n, xs...);
                           ^
./migraphx/kernels/reduce.hpp:278:43: note: called by 'operator()<migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 1, migraphx::integral_constant<unsigned int, 16>> &>'
        return [=](auto&&... xs) { return f(get_size(xs...), make_inner_slice(xs)...); };
                                          ^
./migraphx/kernels/softmax.hpp:41:24: note: called by 'operator()<migraphx::array<unsigned int, 3>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>>'
2 errors generated when compiling for gfx908.
        const auto c = r.reduce(op::max{}, lowest{}, op::id{})(input);
                       ^
./migraphx/kernels/reduce.hpp:414:13: note: called by 'operator()<unsigned int>'
            f(out_idx, make(idx, [&](auto input) { return reduce_slice<Output>(input, out_idx); }));
            ^
./migraphx/kernels/index.hpp:160:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:412:53), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i);
               ^
./migraphx/kernels/index.hpp:202:21: note: called by 'for_stride<false, (lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 2621440>, migraphx::integral_constant<unsigned int, 2621440>>'
                    invoke_loop(f, start, _c<0>);
                    ^
./migraphx/kernels/index.hpp:226:9: note: called by 'global_stride<(lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 2621440>>'
        for_stride<false>(global, n, nglobal(), f);
        ^
./migraphx/kernels/reduce.hpp:412:13: note: called by 'run<migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 1>, migraphx::integral_const_array<unsigned int, 65536, 16, 1>>, (lambda at ./migraphx/kernels/softmax.hpp:36:57)>'
        idx.global_stride(nelements * idx.nlocal(), [&](auto i) {
            ^
./migraphx/kernels/softmax.hpp:36:21: note: called by 'softmax<2U, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 16>, migraphx::integral_const_array<unsigned int, 65536, 16, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 16>, migraphx::integral_const_array<unsigned int, 65536, 16, 1>>>>'
    block::template run<reduce::with_axis<Input, Axis>>([&](auto, auto r) {
                    ^
main.cpp:13:9: note: called by 'operator()<migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 16>, migraphx::integral_const_array<unsigned int, 65536, 16, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 16>, migraphx::integral_const_array<unsigned int, 65536, 16, 1>>>>'
        softmax<2>(input, output);
        ^
./migraphx/kernels/vectorize.hpp:257:13: note: called by 'operator()<(lambda at main.cpp:12:74), migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 64>, migraphx::integral_const_array<unsigned int, 262144, 64, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 64>, migraphx::integral_const_array<unsigned int, 262144, 64, 1>>>>'
            f(vectorize_tensor<N, Axis>(xs)...);
            ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
./migraphx/kernels/functional.hpp:273:50: note: called by 'operator()<migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 64>, migraphx::integral_const_array<unsigned int, 262144, 64, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 64>, migraphx::integral_const_array<unsigned int, 262144, 64, 1>>>>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
                                                 ^
./migraphx/kernels/args.hpp:39:12: note: called by 'make_tensors_impl<(lambda at ./migraphx/kernels/functional.hpp:273:25), 0U, 1U, void, void>'
    return f(make_tensor<Ns>::apply(xs)...);
           ^
./migraphx/kernels/args.hpp:45:37: note: called by 'operator()<(lambda at ./migraphx/kernels/functional.hpp:273:25)>'
        return [=](auto f) { return make_tensors_impl(f, detail::gens<sizeof...(xs)>{}, xs...); };
                                    ^
./migraphx/kernels/functional.hpp:273:16: note: called by 'operator()<(lambda at main.cpp:12:74), void *, void *>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
               ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
main.cpp:12:73: note: called by 'softmax_kernel'
    transform_args(make_tensors(), vectorize<4, 2>())(input_p, output_p)([](auto input, auto output) {
                                                                        ^
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
In file included from main.cpp:3  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib):

In file included from                      ^./migraphx/kernels/softmax.hpp
:27:
/usr/include/x86_64-linux-gnu/sys/cdefs.hIn file included from :./migraphx/kernels/reduce.hpp105::3023:
:In file included from  ./migraphx/kernels/ops.hppnote: :expanded from macro '__CONCAT'27
:
./migraphx/kernels/math.hpp:191:56: #define __CONCAT(x,y)   x ## yerror: 
reference to __host__ function '__fmax' in __device__ function                        ^

<scratch space>:117:1:MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax) 
note:                                                        ^expanded from here

__fmax./migraphx/kernels/ops.hpp
:^93
:26: note: called by 'operator()<_Float16, _Float16>'
        return migraphx::max(x, y);
                         ^
./migraphx/kernels/reduce.hpp:110:51: note: called by 'operator()<unsigned int, migraphx::integral_constant<int, 0>>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
                                                  ^
./migraphx/kernels/index.hpp:154:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:110:25), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i, d);
               ^
./migraphx/kernels/index.hpp:202:21: note: called by 'for_stride<true, (lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 64>, migraphx::integral_constant<unsigned int, 64>>'
                    invoke_loop(f, start, _c<0>);
                    ^
./migraphx/kernels/index.hpp:232:9: note: called by 'local_stride<(lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 64>>'
        for_stride<true>(local, n, nlocal(), f);
        ^
./migraphx/kernels/reduce.hpp:110:9: note: called by 'block_reduce<migraphx::op::max, migraphx::lowest, migraphx::integral_constant<unsigned int, 64>, (lambda at ./migraphx/kernels/reduce.hpp:373:51)>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
        ^
./migraphx/kernels/reduce.hpp:373:20: note: called by 'reduce_impl<migraphx::op::max, migraphx::lowest, migraphx::op::id, migraphx::integral_constant<unsigned int, 64>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 1, migraphx::integral_constant<unsigned int, 64>> &>'
            return block_reduce(idx, op, init, n, [&](auto j, auto d) {
                   ^
./migraphx/kernels/reduce.hpp:314:28: note: called by 'operator()<migraphx::integral_constant<unsigned int, 64>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 1, migraphx::integral_constant<unsigned int, 64>>>'
            return derived.reduce_impl(op, init, read, n, xs...);
                           ^
./migraphx/kernels/reduce.hpp:278:43: note: called by 'operator()<migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 1, migraphx::integral_constant<unsigned int, 64>> &>'
        return [=](auto&&... xs) { return f(get_size(xs...), make_inner_slice(xs)...); };
                                          ^
./migraphx/kernels/softmax.hpp:41:24: note: called by 'operator()<migraphx::array<unsigned int, 3>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>>'
        const auto c = r.reduce(op::max{}, lowest{}, op::id{})(input);
                       ^
./migraphx/kernels/reduce.hpp:414:13: note: called by 'operator()<unsigned int>'
            f(out_idx, make(idx, [&](auto input) { return reduce_slice<Output>(input, out_idx); }));
            ^
./migraphx/kernels/index.hpp:160:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:412:53), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i);
               ^
./migraphx/kernels/index.hpp:202:21: note: called by 'for_stride<false, (lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 655360>, migraphx::integral_constant<unsigned int, 655360>>'
                    invoke_loop(f, start, _c<0>);
                    ^
./migraphx/kernels/index.hpp:226:9: note: called by 'global_stride<(lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 655360>>'
        for_stride<false>(global, n, nglobal(), f);
        ^
./migraphx/kernels/reduce.hpp:412:13: note: called by 'run<migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 1>, migraphx::integral_const_array<unsigned int, 16384, 64, 1>>, (lambda at ./migraphx/kernels/softmax.hpp:36:57)>'
        idx.global_stride(nelements * idx.nlocal(), [&](auto i) {
            ^
./migraphx/kernels/softmax.hpp:36:21: note: called by 'softmax<2U, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 64>, migraphx::integral_const_array<unsigned int, 16384, 64, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 64>, migraphx::integral_const_array<unsigned int, 16384, 64, 1>>>>'
    block::template run<reduce::with_axis<Input, Axis>>([&](auto, auto r) {
                    ^
main.cpp:13:9: note: called by 'operator()<migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 64>, migraphx::integral_const_array<unsigned int, 16384, 64, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 64>, migraphx::integral_const_array<unsigned int, 16384, 64, 1>>>>'
        softmax<2>(input, output);
        ^
./migraphx/kernels/vectorize.hpp:257:13: note: called by 'operator()<(lambda at main.cpp:12:74), migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 256>, migraphx::integral_const_array<unsigned int, 65536, 256, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 256>, migraphx::integral_const_array<unsigned int, 65536, 256, 1>>>>'
            f(vectorize_tensor<N, Axis>(xs)...);
            ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
./migraphx/kernels/functional.hpp:273:50: note: called by 'operator()<migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 256>, migraphx::integral_const_array<unsigned int, 65536, 256, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 40, 256, 256>, migraphx::integral_const_array<unsigned int, 65536, 256, 1>>>>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
                                                 ^
./migraphx/kernels/args.hpp:39:12: note: called by 'make_tensors_impl<(lambda at ./migraphx/kernels/functional.hpp:273:25), 0U, 1U, void, void>'
    return f(make_tensor<Ns>::apply(xs)...);
           ^
./migraphx/kernels/args.hpp:45:37: note: called by 'operator()<(lambda at ./migraphx/kernels/functional.hpp:273:25)>'
        return [=](auto f) { return make_tensors_impl(f, detail::gens<sizeof...(xs)>{}, xs...); };
                                    ^
./migraphx/kernels/functional.hpp:273:16: note: called by 'operator()<(lambda at main.cpp:12:74), void *, void *>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
               ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
main.cpp:12:73: note: called by 'softmax_kernel'
    transform_args(make_tensors(), vectorize<4, 2>())(input_p, output_p)([](auto input, auto output) {
                                                                        ^
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
3 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
3 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
In file included from main.cpp:3:
In file included from ./migraphx/kernels/softmax.hpp:27:
In file included from ./migraphx/kernels/reduce.hpp:30:
In file included from ./migraphx/kernels/ops.hpp:27:
./migraphx/kernels/math.hpp:191:56: error: reference to __host__ function '__fmax' in __device__ function
MIGRAPHX_DEVICE_MATH_BINARY_FOR(migraphx::half, max, ::__hmax)
                                                       ^
./migraphx/kernels/ops.hpp:93:26: note: called by 'operator()<_Float16, _Float16>'
        return migraphx::max(x, y);
                         ^
./migraphx/kernels/reduce.hpp:110:51: note: called by 'operator()<unsigned int, migraphx::integral_constant<int, 3>>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
                                                  ^
./migraphx/kernels/index.hpp:154:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:110:25), unsigned int, migraphx::integral_constant<int, 3>>'
        return f(i, d);
               ^
./migraphx/kernels/index.hpp:170:21: note: called by 'operator()<migraphx::integral_constant<int, 3>, migraphx::integral_constant<unsigned int, 3>>'
                    invoke_loop(f, i, d);
                    ^
./migraphx/kernels/functional.hpp:181:25: note: called by 'fold_impl<const (lambda at ./migraphx/kernels/index.hpp:167:18) &, migraphx::integral_constant<int, 3>, migraphx::integral_constant<unsigned int, 3> &>'
    return fold_impl(f, f(static_cast<T&&>(x), static_cast<U&&>(y)), static_cast<Ts&&>(xs)...);
                        ^
./migraphx/kernels/functional.hpp:181:12: note: called by 'fold_impl<const (lambda at ./migraphx/kernels/index.hpp:167:18) &, migraphx::integral_constant<int, 2>, migraphx::integral_constant<unsigned int, 2> &, migraphx::integral_constant<unsigned int, 3> &>'
    return fold_impl(f, f(static_cast<T&&>(x), static_cast<U&&>(y)), static_cast<Ts&&>(xs)...);
           ^
./migraphx/kernels/functional.hpp:181:12: note: called by 'fold_impl<const (lambda at ./migraphx/kernels/index.hpp:167:18) &, migraphx::integral_constant<int, 1>, migraphx::integral_constant<unsigned int, 1> &, migraphx::integral_constant<unsigned int, 2> &, migraphx::integral_constant<unsigned int, 3> &>'
./migraphx/kernels/functional.hpp:181:12: note: called by 'fold_impl<const (lambda at ./migraphx/kernels/index.hpp:167:18) &, const migraphx::integral_constant<int, 0> &, migraphx::integral_constant<unsigned int, 0> &, migraphx::integral_constant<unsigned int, 1> &, migraphx::integral_constant<unsigned int, 2> &, migraphx::integral_constant<unsigned int, 3> &>'
./migraphx/kernels/functional.hpp:187:39: note: called by 'operator()<const migraphx::integral_constant<int, 0> &, migraphx::integral_constant<unsigned int, 0> &, migraphx::integral_constant<unsigned int, 1> &, migraphx::integral_constant<unsigned int, 2> &, migraphx::integral_constant<unsigned int, 3> &>'
    return [=](auto&&... xs) { return fold_impl(f, static_cast<decltype(xs)&&>(xs)...); };
                                      ^
./migraphx/kernels/index.hpp:167:13: note: called by 'operator()<migraphx::integral_constant<unsigned int, 0>, migraphx::integral_constant<unsigned int, 1>, migraphx::integral_constant<unsigned int, 2>, migraphx::integral_constant<unsigned int, 3>>'
            fold([&](auto d, auto k) {
            ^
./migraphx/kernels/functional.hpp:118:12: note: called by 'sequence_c_impl<(lambda at ./migraphx/kernels/index.hpp:166:52) &, 0U, 1U, 2U, 3U>'
    return f(index_constant<Ns>{}...);
           ^
./migraphx/kernels/functional.hpp:138:20: note: called by 'sequence_c<4U, (lambda at ./migraphx/kernels/index.hpp:166:52) &>'
    return detail::sequence_c_impl(f, detail::gens<N>{});
                   ^
./migraphx/kernels/functional.hpp:144:12: note: called by 'sequence<migraphx::integral_constant<unsigned int, 4>, (lambda at ./migraphx/kernels/index.hpp:166:52)>'
    return sequence_c<ic>(f);
           ^
./migraphx/kernels/index.hpp:166:9: note: called by 'for_stride_loop_unroll<(lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 1024>, migraphx::integral_constant<unsigned int, 256>>'
        sequence(max_stride_iterations(n, stride), [&](auto... ks) {
        ^
./migraphx/kernels/index.hpp:209:21: note: called by 'for_stride<true, (lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 1024>, migraphx::integral_constant<unsigned int, 256>>'
                    for_stride_loop_unroll(start, n, stride, f);
                    ^
./migraphx/kernels/index.hpp:232:9: note: called by 'local_stride<(lambda at ./migraphx/kernels/reduce.hpp:110:25), migraphx::integral_constant<unsigned int, 1024>>'
        for_stride<true>(local, n, nlocal(), f);
        ^
./migraphx/kernels/reduce.hpp:110:9: note: called by 'block_reduce<migraphx::op::max, migraphx::lowest, migraphx::integral_constant<unsigned int, 1024>, (lambda at ./migraphx/kernels/reduce.hpp:373:51)>'
    idx.local_stride(n, [&](auto i, auto d) { x = op(x, index::invoke_loop(f, i, d)); });
        ^
./migraphx/kernels/reduce.hpp:373:20: note: called by 'reduce_impl<migraphx::op::max, migraphx::lowest, migraphx::op::id, migraphx::integral_constant<unsigned int, 1024>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 4, migraphx::integral_constant<unsigned int, 1024>> &>'
            return block_reduce(idx, op, init, n, [&](auto j, auto d) {
                   ^
./migraphx/kernels/reduce.hpp:314:28: note: called by 'operator()<migraphx::integral_constant<unsigned int, 1024>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 4, migraphx::integral_constant<unsigned int, 1024>>>'
            return derived.reduce_impl(op, init, read, n, xs...);
                           ^
./migraphx/kernels/reduce.hpp:278:43: note: called by 'operator()<migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>::inner_storage<_Float16 __attribute__((ext_vector_type(4))), 4, migraphx::integral_constant<unsigned int, 1024>> &>'
        return [=](auto&&... xs) { return f(get_size(xs...), make_inner_slice(xs)...); };
                                          ^
./migraphx/kernels/softmax.hpp:41:24: note: called by 'operator()<migraphx::array<unsigned int, 3>, migraphx::reduce::block::reducer<(lambda at ./migraphx/kernels/reduce.hpp:414:34)>>'
        const auto c = r.reduce(op::max{}, lowest{}, op::id{})(input);
                       ^
./migraphx/kernels/reduce.hpp:414:13: note: called by 'operator()<unsigned int>'
            f(out_idx, make(idx, [&](auto input) { return reduce_slice<Output>(input, out_idx); }));
            ^
./migraphx/kernels/index.hpp:160:16: note: called by 'invoke_loop<(lambda at ./migraphx/kernels/reduce.hpp:412:53), unsigned int, migraphx::integral_constant<int, 0>>'
        return f(i);
               ^
./migraphx/kernels/index.hpp:202:21: note: called by 'for_stride<false, (lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 10485760>, migraphx::integral_constant<unsigned int, 10485760>>'
                    invoke_loop(f, start, _c<0>);
                    ^
./migraphx/kernels/index.hpp:226:9: note: called by 'global_stride<(lambda at ./migraphx/kernels/reduce.hpp:412:53), migraphx::integral_constant<unsigned int, 10485760>>'
        for_stride<false>(global, n, nglobal(), f);
        ^
./migraphx/kernels/reduce.hpp:412:13: note: called by 'run<migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 1>, migraphx::integral_const_array<unsigned int, 4194304, 1024, 1>>, (lambda at ./migraphx/kernels/softmax.hpp:36:57)>'
        idx.global_stride(nelements * idx.nlocal(), [&](auto i) {
            ^
./migraphx/kernels/softmax.hpp:36:21: note: called by 'softmax<2U, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 1024>, migraphx::integral_const_array<unsigned int, 4194304, 1024, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 1024>, migraphx::integral_const_array<unsigned int, 4194304, 1024, 1>>>>'
    block::template run<reduce::with_axis<Input, Axis>>([&](auto, auto r) {
                    ^
main.cpp:13:9: note: called by 'operator()<migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 1024>, migraphx::integral_const_array<unsigned int, 4194304, 1024, 1>>>, migraphx::tensor_view<_Float16 __attribute__((ext_vector_type(4))), migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 1024>, migraphx::integral_const_array<unsigned int, 4194304, 1024, 1>>>>'
        softmax<2>(input, output);
        ^
./migraphx/kernels/vectorize.hpp:257:13: note: called by 'operator()<(lambda at main.cpp:12:74), migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 4096>, migraphx::integral_const_array<unsigned int, 16777216, 4096, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 4096>, migraphx::integral_const_array<unsigned int, 16777216, 4096, 1>>>>'
            f(vectorize_tensor<N, Axis>(xs)...);
            ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
./migraphx/kernels/functional.hpp:273:50: note: called by 'operator()<migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 4096>, migraphx::integral_const_array<unsigned int, 16777216, 4096, 1>>>, migraphx::tensor_view<_Float16, migraphx::shape<migraphx::integral_const_array<unsigned int, 10, 4096, 4096>, migraphx::integral_const_array<unsigned int, 16777216, 4096, 1>>>>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
                                                 ^
./migraphx/kernels/args.hpp:39:12: note: called by 'make_tensors_impl<(lambda at ./migraphx/kernels/functional.hpp:273:25), 0U, 1U, void, void>'
    return f(make_tensor<Ns>::apply(xs)...);
           ^
./migraphx/kernels/args.hpp:45:37: note: called by 'operator()<(lambda at ./migraphx/kernels/functional.hpp:273:25)>'
        return [=](auto f) { return make_tensors_impl(f, detail::gens<sizeof...(xs)>{}, xs...); };
                                    ^
./migraphx/kernels/functional.hpp:273:16: note: called by 'operator()<(lambda at main.cpp:12:74), void *, void *>'
        return f(xs...)([=](auto... ys) { return transform_args(fs...)(ys...)(g); });
               ^
./migraphx/kernels/functional.hpp:257:58: note: called by 'operator()<(lambda at main.cpp:12:74)>'
    return [=](auto... xs) { return [=](auto g) { return f(g, xs...); }; };
                                                         ^
main.cpp:12:73: note: called by 'softmax_kernel'
    transform_args(make_tensors(), vectorize<4, 2>())(input_p, output_p)([](auto input, auto output) {
                                                                        ^
/usr/include/x86_64-linux-gnu/bits/mathcalls.h:329:1: note: '__fmax' declared here
__MATHCALLX (fmax,, (_Mdouble_ __x, _Mdouble_ __y), (__const__));
^
/usr/include/math.h:278:3: note: expanded from macro '__MATHCALLX'
  __MATHDECLX (_Mdouble_,function,suffix, args, attrib)
  ^
/usr/include/math.h:281:22: note: expanded from macro '__MATHDECLX'
  __MATHDECL_1(type, __CONCAT(__,function),suffix, args) __attribute__ (attrib)
                     ^
/usr/include/x86_64-linux-gnu/sys/cdefs.h:105:23: note: expanded from macro '__CONCAT'
#define __CONCAT(x,y)   x ## y
                        ^
<scratch space>:117:1: note: expanded from here
__fmax
^
3 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
2 errors generated when compiling for gfx908.
